<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portfolio Admin Panel</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #181818 0%, #232323 100%);
      color: #fff;
      font-family: 'Poppins', sans-serif;
      min-height: 100vh;
      margin: 0;
    }
    .admin-container {
      max-width: 950px;
      margin: 40px auto;
      background: #232323;
      border-radius: 20px;
      padding: 0 0 32px 0;
      box-shadow: 0 8px 32px #0008, 0 1.5px 0 #ffc857;
      border: 1.5px solid #333;
      position: relative;
      overflow: hidden;
    }
    h1 {
      text-align: center;
      margin: 0;
      padding: 32px 0 16px 0;
      font-size: 2.2rem;
      color: #ffc857;
      font-weight: 600;
      letter-spacing: 1px;
      background: #232323;
      border-bottom: 1.5px solid #333;
    }
    .tabs {
      display: flex;
      border-bottom: 1.5px solid #333;
      background: #232323;
      position: sticky;
      top: 0;
      z-index: 2;
    }
    .tab-btn {
      flex: 1;
      padding: 18px 0;
      background: none;
      border: none;
      color: #ffc857;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      border-bottom: 3px solid transparent;
    }
    .tab-btn.active {
      background: #181818;
      color: #fff;
      border-bottom: 3px solid #ffc857;
    }
    .tab-content {
      display: none;
      padding: 32px 32px 0 32px;
      animation: fadein 0.3s;
    }
    .tab-content.active { display: block; }
    @keyframes fadein { from { opacity: 0; } to { opacity: 1; } }
    .form-group { margin-bottom: 22px; }
    label { display: block; margin-bottom: 6px; color: #ffc857; font-weight: 500; }
    input[type="text"], input[type="number"], textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1.5px solid #444;
      background: #181818;
      color: #fff;
      font-size: 1rem;
      font-family: inherit;
      margin-bottom: 2px;
      transition: border 0.2s;
    }
    input:focus, textarea:focus { border: 1.5px solid #ffc857; outline: none; }
    textarea { min-height: 60px; resize: vertical; }
    .list-section { margin-bottom: 30px; }
    .list-item {
      background: #181818;
      border-radius: 10px;
      padding: 18px 18px 10px 18px;
      margin-bottom: 18px;
      position: relative;
      box-shadow: 0 2px 8px #0002;
    }
    .remove-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #ff5a36;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 4px 12px;
      font-size: 0.95em;
      cursor: pointer;
      transition: background 0.2s;
    }
    .remove-btn:hover { background: #ff2a00; }
    .add-btn {
      background: #ffc857;
      color: #232323;
      border: none;
      border-radius: 8px;
      padding: 8px 22px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      margin-top: 8px;
      margin-bottom: 18px;
      transition: background 0.2s, color 0.2s;
    }
    .add-btn:hover { background: #ffd76a; color: #181818; }
    .save-btn {
      background: linear-gradient(90deg, #ffc857 60%, #ffb300 100%);
      color: #232323;
      border: none;
      border-radius: 8px;
      padding: 14px 40px;
      font-size: 1.1em;
      font-weight: 700;
      cursor: pointer;
      margin: 32px auto 0 auto;
      display: block;
      box-shadow: 0 2px 8px #0002;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s;
    }
    .save-btn:hover { background: linear-gradient(90deg, #ffd76a 60%, #ffc857 100%); color: #181818; box-shadow: 0 4px 16px #ffc85744; }
    .msg {
      margin: 18px 0 0 0;
      font-size: 1.08em;
      min-height: 22px;
      padding: 6px 0 6px 0;
      font-weight: 500;
      border-radius: 6px;
      text-align: center;
      transition: color 0.2s, background 0.2s;
    }
    .msg.success { color: #232323; background: #ffc857; }
    .msg.error { color: #fff; background: #ff5a36; }
    @media (max-width: 700px) {
      .admin-container { padding: 0 0 16px 0; }
      .tab-content { padding: 24px 6vw 0 6vw; }
    }
    @media (max-width: 500px) {
      .tab-content { padding: 16px 2vw 0 2vw; }
      h1 { font-size: 1.3rem; padding: 18px 0 10px 0; }
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <h1>Portfolio Admin Panel</h1>
    <div class="tabs">
      <button class="tab-btn active" data-tab="about">About</button>
      <button class="tab-btn" data-tab="services">Services</button>
      <button class="tab-btn" data-tab="projects">Projects</button>
      <button class="tab-btn" data-tab="testimonials">Testimonials</button>
      <button class="tab-btn" data-tab="certificates">Certificates</button>
      <button class="tab-btn" data-tab="education">Education</button>
      <button class="tab-btn" data-tab="experience">Experience</button>
      <button class="tab-btn" data-tab="skills">Skills</button>
    </div>
    <form id="admin-form">
      <div class="tab-content active" id="tab-about"></div>
      <div class="tab-content" id="tab-services"></div>
      <div class="tab-content" id="tab-projects"></div>
      <div class="tab-content" id="tab-testimonials"></div>
      <div class="tab-content" id="tab-certificates"></div>
      <div class="tab-content" id="tab-education"></div>
      <div class="tab-content" id="tab-experience"></div>
      <div class="tab-content" id="tab-skills"></div>
      <button type="button" class="save-btn" id="save-btn">Save Changes</button>
      <div class="msg" id="msg"></div>
    </form>
  </div>
  <script>
    // Tab switching
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.onclick = function() {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
      };
    });

    // Helper: create input
    function createInput(type, value, placeholder, name, required=false) {
      const input = document.createElement(type === 'textarea' ? 'textarea' : 'input');
      if (type !== 'textarea') input.type = type;
      input.value = value || '';
      input.placeholder = placeholder || '';
      if (name) input.name = name;
      if (required) input.required = true;
      return input;
    }

    // Helper: create label+input
    function labeledInput(labelText, input) {
      const div = document.createElement('div');
      div.className = 'form-group';
      const label = document.createElement('label');
      label.textContent = labelText;
      div.appendChild(label);
      div.appendChild(input);
      return div;
    }

    // Load content.json and render forms
    let content = {};
    fetch('content.json')
      .then(r => r.json())
      .then(data => {
        content = data;
        renderAll();
      })
      .catch(() => {
        content = {};
        renderAll();
      });

    function renderAll() {
      renderAbout();
      renderServices();
      renderProjects();
      renderTestimonials();
      renderCertificates();
      renderEducation();
      renderExperience();
      renderSkills();
    }

    // ABOUT
    function renderAbout() {
      const tab = document.getElementById('tab-about');
      tab.innerHTML = '';
      tab.appendChild(labeledInput('Name', createInput('text', content.about?.name, 'Full Name', 'about-name', true)));
      tab.appendChild(labeledInput('Title', createInput('text', content.about?.title, 'Title', 'about-title', true)));
      const desc = createInput('textarea', (content.about?.description||[]).join('\n\n'), 'Description (one paragraph per line)', 'about-description', true);
      tab.appendChild(labeledInput('Description', desc));
    }

    // SERVICES
    function renderServices() {
      const tab = document.getElementById('tab-services');
      tab.innerHTML = '';
      const list = document.createElement('div');
      list.className = 'list-section';
      (content.services||[]).forEach((service, i) => {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.appendChild(labeledInput('Icon filename', createInput('text', service.icon, 'icon-it-support.png', `service-icon-${i}`)));
        item.appendChild(labeledInput('Title', createInput('text', service.title, 'Service Title', `service-title-${i}`)));
        item.appendChild(labeledInput('Text', createInput('textarea', service.text, 'Service Description', `service-text-${i}`)));
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'remove-btn';
        remove.textContent = 'Remove';
        remove.onclick = () => { content.services.splice(i,1); renderServices(); };
        item.appendChild(remove);
        list.appendChild(item);
      });
      const add = document.createElement('button');
      add.type = 'button';
      add.className = 'add-btn';
      add.textContent = '+ Add Service';
      add.onclick = () => { (content.services = content.services||[]).push({icon:'',title:'',text:''}); renderServices(); };
      tab.appendChild(list);
      tab.appendChild(add);
    }

    // PROJECTS
    function renderProjects() {
      const tab = document.getElementById('tab-projects');
      tab.innerHTML = '';
      const list = document.createElement('div');
      list.className = 'list-section';
      (content.projects||[]).forEach((project, i) => {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.appendChild(labeledInput('Title', createInput('text', project.title, 'Project Title', `project-title-${i}`)));
        item.appendChild(labeledInput('Category', createInput('text', project.category, 'Web Development', `project-category-${i}`)));
        item.appendChild(labeledInput('Type', createInput('text', project.type, 'python projects', `project-type-${i}`)));
        item.appendChild(labeledInput('Image filename', createInput('text', project.image, 'project.png', `project-image-${i}`)));
        item.appendChild(labeledInput('Alt text', createInput('text', project.alt, 'Project Image', `project-alt-${i}`)));
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'remove-btn';
        remove.textContent = 'Remove';
        remove.onclick = () => { content.projects.splice(i,1); renderProjects(); };
        item.appendChild(remove);
        list.appendChild(item);
      });
      const add = document.createElement('button');
      add.type = 'button';
      add.className = 'add-btn';
      add.textContent = '+ Add Project';
      add.onclick = () => { (content.projects = content.projects||[]).push({title:'',category:'',type:'',image:'',alt:''}); renderProjects(); };
      tab.appendChild(list);
      tab.appendChild(add);
    }

    // TESTIMONIALS
    function renderTestimonials() {
      const tab = document.getElementById('tab-testimonials');
      tab.innerHTML = '';
      const list = document.createElement('div');
      list.className = 'list-section';
      (content.testimonials||[]).forEach((t, i) => {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.appendChild(labeledInput('Avatar filename', createInput('text', t.avatar, 'avatar-1.png', `testimonial-avatar-${i}`)));
        item.appendChild(labeledInput('Name', createInput('text', t.name, 'Name', `testimonial-name-${i}`)));
        item.appendChild(labeledInput('Text', createInput('textarea', t.text, 'Testimonial', `testimonial-text-${i}`)));
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'remove-btn';
        remove.textContent = 'Remove';
        remove.onclick = () => { content.testimonials.splice(i,1); renderTestimonials(); };
        item.appendChild(remove);
        list.appendChild(item);
      });
      const add = document.createElement('button');
      add.type = 'button';
      add.className = 'add-btn';
      add.textContent = '+ Add Testimonial';
      add.onclick = () => { (content.testimonials = content.testimonials||[]).push({avatar:'',name:'',text:''}); renderTestimonials(); };
      tab.appendChild(list);
      tab.appendChild(add);
    }

    // CERTIFICATES
    function renderCertificates() {
      const tab = document.getElementById('tab-certificates');
      tab.innerHTML = '';
      const list = document.createElement('div');
      list.className = 'list-section';
      (content.certificates||[]).forEach((c, i) => {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.appendChild(labeledInput('Logo filename', createInput('text', c.logo, 'logo.png', `certificate-logo-${i}`)));
        item.appendChild(labeledInput('Alt text', createInput('text', c.alt, 'Logo alt', `certificate-alt-${i}`)));
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'remove-btn';
        remove.textContent = 'Remove';
        remove.onclick = () => { content.certificates.splice(i,1); renderCertificates(); };
        item.appendChild(remove);
        list.appendChild(item);
      });
      const add = document.createElement('button');
      add.type = 'button';
      add.className = 'add-btn';
      add.textContent = '+ Add Certificate';
      add.onclick = () => { (content.certificates = content.certificates||[]).push({logo:'',alt:''}); renderCertificates(); };
      tab.appendChild(list);
      tab.appendChild(add);
    }

    // EDUCATION
    function renderEducation() {
      const tab = document.getElementById('tab-education');
      tab.innerHTML = '';
      const list = document.createElement('div');
      list.className = 'list-section';
      (content.education||[]).forEach((e, i) => {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.appendChild(labeledInput('School', createInput('text', e.school, 'School', `education-school-${i}`)));
        item.appendChild(labeledInput('Years', createInput('text', e.years, '2019 — 2023', `education-years-${i}`)));
        item.appendChild(labeledInput('Text', createInput('textarea', e.text, 'Description', `education-text-${i}`)));
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'remove-btn';
        remove.textContent = 'Remove';
        remove.onclick = () => { content.education.splice(i,1); renderEducation(); };
        item.appendChild(remove);
        list.appendChild(item);
      });
      const add = document.createElement('button');
      add.type = 'button';
      add.className = 'add-btn';
      add.textContent = '+ Add Education';
      add.onclick = () => { (content.education = content.education||[]).push({school:'',years:'',text:''}); renderEducation(); };
      tab.appendChild(list);
      tab.appendChild(add);
    }

    // EXPERIENCE
    function renderExperience() {
      const tab = document.getElementById('tab-experience');
      tab.innerHTML = '';
      const list = document.createElement('div');
      list.className = 'list-section';
      (content.experience||[]).forEach((e, i) => {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.appendChild(labeledInput('Title', createInput('text', e.title, 'Title', `experience-title-${i}`)));
        item.appendChild(labeledInput('Company', createInput('text', e.company, 'Company', `experience-company-${i}`)));
        item.appendChild(labeledInput('Years', createInput('text', e.years, '2020 — 2022', `experience-years-${i}`)));
        item.appendChild(labeledInput('Text', createInput('textarea', e.text, 'Description', `experience-text-${i}`)));
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'remove-btn';
        remove.textContent = 'Remove';
        remove.onclick = () => { content.experience.splice(i,1); renderExperience(); };
        item.appendChild(remove);
        list.appendChild(item);
      });
      const add = document.createElement('button');
      add.type = 'button';
      add.className = 'add-btn';
      add.textContent = '+ Add Experience';
      add.onclick = () => { (content.experience = content.experience||[]).push({title:'',company:'',years:'',text:''}); renderExperience(); };
      tab.appendChild(list);
      tab.appendChild(add);
    }

    // SKILLS
    function renderSkills() {
      const tab = document.getElementById('tab-skills');
      tab.innerHTML = '';
      const list = document.createElement('div');
      list.className = 'list-section';
      (content.skills||[]).forEach((s, i) => {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.appendChild(labeledInput('Name', createInput('text', s.name, 'Skill', `skill-name-${i}`)));
        item.appendChild(labeledInput('Value (%)', createInput('number', s.value, '90', `skill-value-${i}`)));
        const remove = document.createElement('button');
        remove.type = 'button';
        remove.className = 'remove-btn';
        remove.textContent = 'Remove';
        remove.onclick = () => { content.skills.splice(i,1); renderSkills(); };
        item.appendChild(remove);
        list.appendChild(item);
      });
      const add = document.createElement('button');
      add.type = 'button';
      add.className = 'add-btn';
      add.textContent = '+ Add Skill';
      add.onclick = () => { (content.skills = content.skills||[]).push({name:'',value:0}); renderSkills(); };
      tab.appendChild(list);
      tab.appendChild(add);
    }

    // Save to backend
    document.getElementById('save-btn').onclick = function() {
      // Gather all form data
      const f = document.getElementById('admin-form');
      // About
      content.about = {
        name: f['about-name'].value,
        title: f['about-title'].value,
        description: f['about-description'].value.split(/\n\n+/).map(s=>s.trim()).filter(Boolean)
      };
      // Services
      if (content.services) content.services = content.services.map((s,i) => ({
        icon: f[`service-icon-${i}`].value,
        title: f[`service-title-${i}`].value,
        text: f[`service-text-${i}`].value
      }));
      // Projects
      if (content.projects) content.projects = content.projects.map((p,i) => ({
        title: f[`project-title-${i}`].value,
        category: f[`project-category-${i}`].value,
        type: f[`project-type-${i}`].value,
        image: f[`project-image-${i}`].value,
        alt: f[`project-alt-${i}`].value
      }));
      // Testimonials
      if (content.testimonials) content.testimonials = content.testimonials.map((t,i) => ({
        avatar: f[`testimonial-avatar-${i}`].value,
        name: f[`testimonial-name-${i}`].value,
        text: f[`testimonial-text-${i}`].value
      }));
      // Certificates
      if (content.certificates) content.certificates = content.certificates.map((c,i) => ({
        logo: f[`certificate-logo-${i}`].value,
        alt: f[`certificate-alt-${i}`].value
      }));
      // Education
      if (content.education) content.education = content.education.map((e,i) => ({
        school: f[`education-school-${i}`].value,
        years: f[`education-years-${i}`].value,
        text: f[`education-text-${i}`].value
      }));
      // Experience
      if (content.experience) content.experience = content.experience.map((e,i) => ({
        title: f[`experience-title-${i}`].value,
        company: f[`experience-company-${i}`].value,
        years: f[`experience-years-${i}`].value,
        text: f[`experience-text-${i}`].value
      }));
      // Skills
      if (content.skills) content.skills = content.skills.map((s,i) => ({
        name: f[`skill-name-${i}`].value,
        value: Number(f[`skill-value-${i}`].value)
      }));
      // Send to backend
      const token = prompt('Enter admin token:');
      fetch('/api/update-content', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-admin-token': token || ''
        },
        body: JSON.stringify(content)
      })
      .then(r => r.json())
      .then(res => {
        if (res.success) {
          document.getElementById('msg').textContent = 'Content updated successfully!';
          document.getElementById('msg').className = 'msg success';
        } else {
          document.getElementById('msg').textContent = 'Error: ' + (res.error || 'Unknown error');
          document.getElementById('msg').className = 'msg error';
        }
      })
      .catch(() => {
        document.getElementById('msg').textContent = 'Error: Could not connect to backend.';
        document.getElementById('msg').className = 'msg error';
      });
    };
  </script>
</body>
</html>
